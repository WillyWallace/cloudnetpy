
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>High-level APIs &#8212; CloudnetPy  documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Quickstart" href="quickstart.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="quickstart.html" title="Quickstart"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CloudnetPy  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="high-level-apis">
<h1>High-level APIs<a class="headerlink" href="#high-level-apis" title="Permalink to this headline">¶</a></h1>
<p>CloudnetPy’s high-level APIs provide a simple way to process
cloud remote sensing measurements into Cloudnet products, without
needing to worry about implementation details.</p>
<p>The APIs enable users to set up an operational processing
system that doesn’t require major modifications
if the underlaying methods and their implementations change
from one software version to another.</p>
<dl class="function">
<dt id="mira.mira2nc">
<code class="descclassname">mira.</code><code class="descname">mira2nc</code><span class="sig-paren">(</span><em>mmclx_file</em>, <em>output_file</em>, <em>site_properties</em>, <em>rebin_data=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mira.html#mira2nc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mira.mira2nc" title="Permalink to this definition">¶</a></dt>
<dd><p>High-level API to convert Mira cloud radar Level 1 file into NetCDF file.</p>
<p>This function converts raw cloud radar file into a much smaller file that
contains only the relevant data and can be used in further processing steps.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mmclx_file</strong> (<em>str</em>) – Raw radar file in NetCDF format.</li>
<li><strong>output_file</strong> (<em>str</em>) – Output file name.</li>
<li><strong>site_properties</strong> (<em>dict</em>) – ‘location’, ‘latitude’, ‘longitude’,
‘altitude’ (m).</li>
<li><strong>rebin_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, rebins data to 30s resolution.
Otherwise keeps the native resolution. Default is False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cloudnetpy.mira</span> <span class="k">import</span> <span class="n">mira2nc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">site_properties</span> <span class="o">=</span> <span class="p">{</span>
<span class="go">&#39;location&#39;: &#39;Vehmasmäki&#39;,</span>
<span class="go">&#39;latitude&#39;: 62.74,</span>
<span class="go">&#39;longitude&#39;: 27.53,</span>
<span class="go">&#39;altitude&#39;: 155}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mira2nc</span><span class="p">(</span><span class="s1">&#39;raw_radar.mmclx&#39;</span><span class="p">,</span> <span class="s1">&#39;radar.nc&#39;</span><span class="p">,</span> <span class="n">site_properties</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="rpg.rpg2nc">
<code class="descclassname">rpg.</code><code class="descname">rpg2nc</code><span class="sig-paren">(</span><em>path_to_l1_files</em>, <em>output_file</em>, <em>site_properties</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rpg.html#rpg2nc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rpg.rpg2nc" title="Permalink to this definition">¶</a></dt>
<dd><p>High-level API to convert RPG binary files into NetCDF file.</p>
<p>This function reads one day of RPG Level 1 cloud radar binary files,
concatenates the data and writes it into NetCDF file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path_to_l1_files</strong> (<em>str</em>) – Folder containing one day of RPG LV1 files.</li>
<li><strong>output_file</strong> (<em>str</em>) – Output file name.</li>
<li><strong>site_properties</strong> (<em>dict</em>) – Dictionary containing information about the
site. Required key value pairs are ‘altitude’ (in metres) and
‘name’.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">site_properties</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">Hyytiala</span><span class="p">,</span> <span class="s1">&#39;altitude&#39;</span><span class="p">:</span> <span class="mi">174</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rpg</span><span class="o">.</span><span class="n">rpg2nc</span><span class="p">(</span><span class="s1">&#39;/path/to/files/&#39;</span><span class="p">,</span> <span class="s1">&#39;test.nc&#39;</span><span class="p">,</span> <span class="n">site_properties</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="categorize.generate_categorize">
<code class="descclassname">categorize.</code><code class="descname">generate_categorize</code><span class="sig-paren">(</span><em>input_files</em>, <em>output_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#generate_categorize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.generate_categorize" title="Permalink to this definition">¶</a></dt>
<dd><p>High-level API to generate Cloudnet categorize file.</p>
<p>The measurements are rebinned into a common height / time grid,
and classified as different types of scatterers such as ice, liquid,
insects, etc. Next, the radar signal is corrected for atmospheric
attenuation, and error estimates are computed. Results are saved
in <em>ouput_file</em> which is by default a compressed NETCDF4_CLASSIC
file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input_files</strong> (<em>dict</em>) – dict containing file names for ‘radar’, ‘lidar’
‘model’ and optionally ‘mwr’ if liquid water path is not
included in the radar file.</li>
<li><strong>output_file</strong> (<em>str</em>) – Full path of the output file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cloudnetpy.categorize</span> <span class="k">import</span> <span class="n">generate_categorize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;radar&#39;</span><span class="p">:</span> <span class="s1">&#39;radar.nc&#39;</span><span class="p">,</span>
<span class="go">                   &#39;lidar&#39;: &#39;lidar.nc&#39;,</span>
<span class="go">                   &#39;model&#39;: &#39;model.nc&#39;,</span>
<span class="go">                   &#39;mwr&#39;: &#39;mwr.nc&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generate_categorize</span><span class="p">(</span><span class="n">input_files</span><span class="p">,</span> <span class="s1">&#39;output.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="modules">
<h1>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h1>
<p>The various modules of CloudnetPy provide additional lower-level
functions that are useful for development, testing and research
purposes.</p>
<div class="section" id="module-categorize">
<span id="cloudnetpy-categorize"></span><h2>cloudnetpy.categorize<a class="headerlink" href="#module-categorize" title="Permalink to this headline">¶</a></h2>
<p>Functions for rebinning input data.</p>
<dl class="class">
<dt id="categorize.DataSource">
<em class="property">class </em><code class="descclassname">categorize.</code><code class="descname">DataSource</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#DataSource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.DataSource" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all Cloudnet measurements and model data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>str</em>) – Calibrated instrument / model NetCDF file.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="categorize.DataSource.filename">
<code class="descname">filename</code><a class="headerlink" href="#categorize.DataSource.filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Filename of the input file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.DataSource.dataset">
<code class="descname">dataset</code><a class="headerlink" href="#categorize.DataSource.dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>A netcdf4 Dataset instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Dataset</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.DataSource.variables">
<code class="descname">variables</code><a class="headerlink" href="#categorize.DataSource.variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Variables of the Dataset instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.DataSource.source">
<code class="descname">source</code><a class="headerlink" href="#categorize.DataSource.source" title="Permalink to this definition">¶</a></dt>
<dd><p>Global attribute ‘source’ from <em>input_file</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.DataSource.time">
<code class="descname">time</code><a class="headerlink" href="#categorize.DataSource.time" title="Permalink to this definition">¶</a></dt>
<dd><p>Time array of the instrument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">MaskedArray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.DataSource.altitude">
<code class="descname">altitude</code><a class="headerlink" href="#categorize.DataSource.altitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Altitude of instrument above mean sea level (m).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.DataSource.data">
<code class="descname">data</code><a class="headerlink" href="#categorize.DataSource.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary containing CloudnetArray instances.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="categorize.DataSource.km2m">
<em class="property">static </em><code class="descname">km2m</code><span class="sig-paren">(</span><em>var</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#DataSource.km2m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.DataSource.km2m" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts km to m.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="categorize.DataSource.m2km">
<em class="property">static </em><code class="descname">m2km</code><span class="sig-paren">(</span><em>var</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#DataSource.m2km"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.DataSource.m2km" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts m to km.</p>
</dd></dl>

<dl class="method">
<dt id="categorize.DataSource.append_data">
<code class="descname">append_data</code><span class="sig-paren">(</span><em>data</em>, <em>key</em>, <em>name=None</em>, <em>units=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#DataSource.append_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.DataSource.append_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds new CloudnetVariable into self.data dictionary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>ndarray</em>) – Data to be added.</li>
<li><strong>key</strong> (<em>str</em>) – Key for self.data dict.</li>
<li><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – CloudnetArray.name attribute. Default value
is <em>key</em>.</li>
<li><strong>units</strong> (<em>str</em><em>, </em><em>optional</em>) – CloudnetArray.units attribute.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="categorize.ProfileDataSource">
<em class="property">class </em><code class="descclassname">categorize.</code><code class="descname">ProfileDataSource</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#ProfileDataSource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.ProfileDataSource" title="Permalink to this definition">¶</a></dt>
<dd><p>ProfileDataSource class, child of DataSource.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>str</em>) – Raw lidar or radar file.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="categorize.ProfileDataSource.height">
<code class="descname">height</code><a class="headerlink" href="#categorize.ProfileDataSource.height" title="Permalink to this definition">¶</a></dt>
<dd><p>Measurement height grid above mean sea level (m).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="categorize.Radar">
<em class="property">class </em><code class="descclassname">categorize.</code><code class="descname">Radar</code><span class="sig-paren">(</span><em>radar_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Radar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Radar" title="Permalink to this definition">¶</a></dt>
<dd><p>Radar class, child of ProfileDataSource.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>radar_file</strong> (<em>str</em>) – File name of the calibrated radar file.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="categorize.Radar.radar_frequency">
<code class="descname">radar_frequency</code><a class="headerlink" href="#categorize.Radar.radar_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Radar frequency (GHz).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.Radar.wl_band">
<code class="descname">wl_band</code><a class="headerlink" href="#categorize.Radar.wl_band" title="Permalink to this definition">¶</a></dt>
<dd><p>Int corresponding to frequency 0 = 35.5 GHz, 1 = 94 GHz.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.Radar.folding_velocity">
<code class="descname">folding_velocity</code><a class="headerlink" href="#categorize.Radar.folding_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Radar’s folding velocity (m/s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.Radar.location">
<code class="descname">location</code><a class="headerlink" href="#categorize.Radar.location" title="Permalink to this definition">¶</a></dt>
<dd><p>Location of the radar, copied from the global attribute
‘location’ of the <em>radar_file</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="categorize.Radar.rebin_to_grid">
<code class="descname">rebin_to_grid</code><span class="sig-paren">(</span><em>time_new</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Radar.rebin_to_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Radar.rebin_to_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebins radar data in time using mean.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time_new</strong> (<em>ndarray</em>) – Target time array as fraction hour. Updates
<em>time</em> attribute.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="categorize.Radar.correct_atten">
<code class="descname">correct_atten</code><span class="sig-paren">(</span><em>attenuations</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Radar.correct_atten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Radar.correct_atten" title="Permalink to this definition">¶</a></dt>
<dd><p>Corrects radar echo for liquid and gas attenuation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>attenuations</strong> (<em>dict</em>) – 2-D attenuations due to atmospheric gases.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="categorize.Radar.calc_errors">
<code class="descname">calc_errors</code><span class="sig-paren">(</span><em>attenuations</em>, <em>classification</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Radar.calc_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Radar.calc_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates error and sensitivity of radar echo.</p>
</dd></dl>

<dl class="method">
<dt id="categorize.Radar.add_meta">
<code class="descname">add_meta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Radar.add_meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Radar.add_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies misc. metadata from the input file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="categorize.Lidar">
<em class="property">class </em><code class="descclassname">categorize.</code><code class="descname">Lidar</code><span class="sig-paren">(</span><em>lidar_file</em>, <em>fields</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Lidar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Lidar" title="Permalink to this definition">¶</a></dt>
<dd><p>Lidar class, child of ProfileDataSource.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lidar_file</strong> (<em>str</em>) – File name of the calibrated lidar file.</li>
<li><strong>fields</strong> (<em>tuple</em>) – Tuple of strings containing fields to be extracted
from the <em>lidar_file</em>, e.g (‘beta’, ‘beta_raw’).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="categorize.Lidar.wavelength">
<code class="descname">wavelength</code><a class="headerlink" href="#categorize.Lidar.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Lidar wavelength (nm).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="categorize.Lidar.rebin_to_grid">
<code class="descname">rebin_to_grid</code><span class="sig-paren">(</span><em>time_new</em>, <em>height_new</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Lidar.rebin_to_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Lidar.rebin_to_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebins lidar data in time and height using mean.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>time_new</strong> (<em>ndarray</em>) – 1-D target time array (fraction hour).</li>
<li><strong>height_new</strong> (<em>ndarray</em>) – 1-D target height array (m).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="categorize.Lidar.add_meta">
<code class="descname">add_meta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Lidar.add_meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Lidar.add_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies misc. metadata from the input file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="categorize.Mwr">
<em class="property">class </em><code class="descclassname">categorize.</code><code class="descname">Mwr</code><span class="sig-paren">(</span><em>mwr_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Mwr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Mwr" title="Permalink to this definition">¶</a></dt>
<dd><p>Microwave radiometer class, child of DataSource.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mwr_file</strong> (<em>str</em>) – File name of the calibrated mwr file.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="categorize.Mwr.interpolate_in_time">
<code class="descname">interpolate_in_time</code><span class="sig-paren">(</span><em>time_grid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Mwr.interpolate_in_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Mwr.interpolate_in_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates liquid water path to Cloudnet’s dense time grid.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="categorize.Model">
<em class="property">class </em><code class="descclassname">categorize.</code><code class="descname">Model</code><span class="sig-paren">(</span><em>model_file</em>, <em>alt_site</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Model class, child of DataSource.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model_file</strong> (<em>str</em>) – File name of the NWP model file.</li>
<li><strong>alt_site</strong> (<em>float</em>) – Altitude of the site above mean sea level (m).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="categorize.Model.type">
<code class="descname">type</code><a class="headerlink" href="#categorize.Model.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Model type, e.g. ‘gdas1’ or ‘ecwmf’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.Model.model_heights">
<code class="descname">model_heights</code><a class="headerlink" href="#categorize.Model.model_heights" title="Permalink to this definition">¶</a></dt>
<dd><p>2-D array of model heights (one for each time
step).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.Model.mean_height">
<code class="descname">mean_height</code><a class="headerlink" href="#categorize.Model.mean_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean of <em>model_heights</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.Model.data_sparse">
<code class="descname">data_sparse</code><a class="headerlink" href="#categorize.Model.data_sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>Model variables in common height grid but without
interpolation in time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="categorize.Model.data_dense">
<code class="descname">data_dense</code><a class="headerlink" href="#categorize.Model.data_dense" title="Permalink to this definition">¶</a></dt>
<dd><p>Model variables interpolated to Cloudnet’s dense
time / height grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="categorize.Model.interpolate_to_common_height">
<code class="descname">interpolate_to_common_height</code><span class="sig-paren">(</span><em>wl_band</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Model.interpolate_to_common_height"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Model.interpolate_to_common_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates model variables to common height grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>wl_band</strong> (<em>int</em>) – Integer denoting the wavelength band of the
radar (0=35.5 GHz, 1=94 GHz).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="categorize.Model.interpolate_to_grid">
<code class="descname">interpolate_to_grid</code><span class="sig-paren">(</span><em>time_grid</em>, <em>height_grid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Model.interpolate_to_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Model.interpolate_to_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates model variables to Cloudnet’s dense time / height grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>time_grid</strong> (<em>ndarray</em>) – The target time array (fraction hour).</li>
<li><strong>height_grid</strong> (<em>ndarray</em>) – The target height array (m).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="categorize.Model.calc_wet_bulb">
<code class="descname">calc_wet_bulb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Model.calc_wet_bulb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Model.calc_wet_bulb" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates wet-bulb temperature in dense grid.</p>
</dd></dl>

<dl class="method">
<dt id="categorize.Model.screen_fields">
<code class="descname">screen_fields</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/categorize.html#Model.screen_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#categorize.Model.screen_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes model fields that we don’t want to write in the output.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-classify">
<span id="cloudnetpy-classify"></span><h2>cloudnetpy.classify<a class="headerlink" href="#module-classify" title="Permalink to this headline">¶</a></h2>
<p>Module containing low-level functions to classify gridded
radar / lidar measurements.</p>
<dl class="class">
<dt id="classify.ClassificationResult">
<em class="property">class </em><code class="descclassname">classify.</code><code class="descname">ClassificationResult</code><span class="sig-paren">(</span><em>category_bits: numpy.ndarray</em>, <em>is_rain: numpy.ndarray</em>, <em>is_clutter: numpy.ndarray</em>, <em>insect_prob: numpy.ndarray</em>, <em>liquid_bases: numpy.ndarray</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/classify.html#ClassificationResult"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#classify.ClassificationResult" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="classify.classify_measurements">
<code class="descclassname">classify.</code><code class="descname">classify_measurements</code><span class="sig-paren">(</span><em>radar</em>, <em>lidar</em>, <em>model</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/classify.html#classify_measurements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#classify.classify_measurements" title="Permalink to this definition">¶</a></dt>
<dd><p>Classifies radar/lidar observations.</p>
<p>This function classifies atmospheric scatterer from the input data.
The input data needs to be averaged or interpolated to the common
time / height grid before calling this function.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">classify.fetch_qual_bits()</p>
</div>
</dd></dl>

<dl class="function">
<dt id="classify.fetch_quality">
<code class="descclassname">classify.</code><code class="descname">fetch_quality</code><span class="sig-paren">(</span><em>radar</em>, <em>lidar</em>, <em>classification</em>, <em>attenuations</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/classify.html#fetch_quality"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#classify.fetch_quality" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Cloudnet quality bits.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>radar</strong> (<a class="reference internal" href="#categorize.Radar" title="categorize.Radar"><em>Radar</em></a>) – Radar data container.</li>
<li><strong>lidar</strong> (<a class="reference internal" href="#categorize.Lidar" title="categorize.Lidar"><em>Lidar</em></a>) – Lidar data container.</li>
<li><strong>classification</strong> (<a class="reference internal" href="#classify.ClassificationResult" title="classify.ClassificationResult"><em>ClassificationResult</em></a>) – Container for classification
results.</li>
<li><strong>attenuations</strong> (<em>dict</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>Integer array containing the following bits:</dt>
<dd><ul class="first last simple">
<li>bit 0: Pixel contains radar data</li>
<li>bit 1: Pixel contains lidar data</li>
<li>bit 2: Pixel contaminated by radar clutter</li>
<li>bit 3: Molecular scattering present (currently not implemented!)</li>
<li>bit 4: Pixel was affected by liquid attenuation</li>
<li>bit 5: Liquid attenuation was corrected</li>
</ul>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">classify.fetch_cat_bits()</p>
</div>
</dd></dl>

<dl class="function">
<dt id="classify.find_aerosols">
<code class="descclassname">classify.</code><code class="descname">find_aerosols</code><span class="sig-paren">(</span><em>beta</em>, <em>is_falling</em>, <em>is_liquid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/classify.html#find_aerosols"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#classify.find_aerosols" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates aerosols from lidar backscattering.</p>
<p>Aerosols are the unmasked pixels in the attenuated backscattering
that are: a) not falling, b) not liquid droplets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>beta</strong> (<em>MaskedArray</em>) – 2-D attenuated backscattering coefficient.</li>
<li><strong>is_falling</strong> (<em>ndarray</em>) – 2-D boolean array of falling hydrometeors.</li>
<li><strong>is_liquid</strong> (<em>ndarray</em>) – 2-D boolean array of liquid droplets.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">2-D boolean array of aerosol classification.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="classify.find_falling_hydrometeors">
<code class="descclassname">classify.</code><code class="descname">find_falling_hydrometeors</code><span class="sig-paren">(</span><em>obs</em>, <em>is_liquid</em>, <em>is_insects</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/classify.html#find_falling_hydrometeors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#classify.find_falling_hydrometeors" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds falling hydrometeors.</p>
<p>Falling hydrometeors are the unmasked radar signals that are
a) not insects b) not clutter. Furthermore, the falling bit
is also <em>True</em> for lidar-detected ice clouds.</p>
<p>To distinguish lidar ice from aerosols is not trivial, though.
This method assumes that lidar signals, that are not from liquid
clouds, with the temperature below -7 C are ice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obs</strong> (<em>ClassData</em>) – Container for observations.</li>
<li><strong>is_liquid</strong> (<em>ndarray</em>) – 2-D boolean array of liquid droplets.</li>
<li><strong>is_insects</strong> (<em>ndarray</em>) – 2-D boolean array of insects.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">2-D boolean array containing falling hydrometeros.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="classify.find_freezing_region">
<code class="descclassname">classify.</code><code class="descname">find_freezing_region</code><span class="sig-paren">(</span><em>obs</em>, <em>melting_layer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/classify.html#find_freezing_region"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#classify.find_freezing_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds freezing region using the model temperature and melting layer.</p>
<p>Every profile that contains melting layer, subzero region starts from
the mean melting layer height. If there are (long) time windows where
no melting layer is present, model temperature is used in the
middle of the time window. Finally, the subzero altitudes are linearly
interpolated for all profiles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obs</strong> (<em>ClassData</em>) – Input data container.</li>
<li><strong>melting_layer</strong> (<em>ndarray</em>) – 2-D boolean array denoting melting layer.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">2-D boolean array denoting the sub-zero region.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>It is not clear how model temperature and melting layer should be
ideally combined to determine the sub-zero region.</p>
</dd></dl>

<dl class="function">
<dt id="classify.find_insects">
<code class="descclassname">classify.</code><code class="descname">find_insects</code><span class="sig-paren">(</span><em>obs</em>, <em>*args</em>, <em>prob_lim=0.8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/classify.html#find_insects"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#classify.find_insects" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns insect probability and boolean array of insect presence.</p>
<p>Insects are detected by calculating heuristic probability of insects using
radar echo, <em>Zh</em>, linear depolarization ratio, <em>ldr</em> and Doppler
width, <em>w</em>. Generally insects have small <em>Zh</em>, high <em>ldr</em> and small <em>w</em>.</p>
<p>If a small echo from temperatures above zero has high <em>ldr</em>,
it most probably contains insects. A probability value between 0 and 1
is assigned using a 2-D probability distribution in <em>ldr</em>-<em>Zh</em> space.</p>
<p>If <em>ldr</em> is not available, we must use <em>w</em> which is not as
good indicator but still usable. Here a fixed value, 0.06, is used
(smaller <em>w</em> values than this are insects).</p>
<p>The approach above generally does not give many false positives but instead
misses a few insect cases. If hordes of insects are present, they can
yield a relatively strong radar signal. Because this is not a typical
insect signature, a too low probability will appear.</p>
<p>Finally, positive insect detections are canceled from profiles with rain,
liquid droplets pixels, melting layer pixels and too cold temperatures.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obs</strong> (<em>ClassData</em>) – Input data container.</li>
<li><strong>*args</strong> – Binary fields that are used to screen the
insect probability. E.g. rain, clutter,
melting_layer, etc.</li>
<li><strong>prob_lim</strong> (<em>float</em><em>, </em><em>optional</em>) – Probability higher than
this will lead to positive detection. Default is 0.8.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>2-element tuple containing</p>
<ul class="simple">
<li>ndarray: 2-D probability of pixel containing insects.</li>
<li>ndarray: 2-D boolean flag of insects presense.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="classify.find_melting_layer">
<code class="descclassname">classify.</code><code class="descname">find_melting_layer</code><span class="sig-paren">(</span><em>obs</em>, <em>smooth=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/classify.html#find_melting_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#classify.find_melting_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds melting layer from model temperature, ldr, and velocity.</p>
<p>Melting layer is detected using linear depolarization ratio, <em>ldr</em>,
Doppler velocity, <em>v</em>, and wet-bulb temperature, <em>Tw</em>.</p>
<p>The algorithm is based on <em>ldr</em> having a clear Gaussian peak around
the melting layer. This signature is caused by the growth of ice
crystals into snowflakes that are much larger. In addition, when snow and
ice melt, emerging heavy water droplets start to drop rapidly towards
ground. Thus, there is also a similar positive peak in the
first difference of <em>v</em>.</p>
<p>The peak in <em>ldr</em> is the primary parameter we analyze. If
<em>ldr</em> has a proper peak, and <em>v</em> &lt; -1 m/s in the base, melting layer
has been found. If <em>ldr</em> is missing we only analyze the behaviour
of <em>v</em>, which is always present, to detect the melting layer.</p>
<p>Model temperature is used to limit the melting layer search to a certain
temperature range around 0 C. For ECMWF the range is -4..+3, and for
the rest -8..+6.</p>
<p class="rubric">Notes</p>
<p>There might be some detection problems with strong updrafts of air.
In these cases the absolute values for speed do not make sense (rain
drops can even move upwards instead of down).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obs</strong> (<em>ClassData</em>) – Input data container.</li>
<li><strong>smooth</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, apply a small
Gaussian smoother to the melting layer. Default is True.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">2-D boolean array denoting the melting layer.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-atmos">
<span id="cloudnetpy-atmos"></span><h2>cloudnetpy.atmos<a class="headerlink" href="#module-atmos" title="Permalink to this headline">¶</a></h2>
<p>This module contains functions to calculate
various atmospheric parameters.</p>
<dl class="function">
<dt id="atmos.c2k">
<code class="descclassname">atmos.</code><code class="descname">c2k</code><span class="sig-paren">(</span><em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/atmos.html#c2k"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#atmos.c2k" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts Celsius to Kelvins.</p>
</dd></dl>

<dl class="function">
<dt id="atmos.dew_point_temperature">
<code class="descclassname">atmos.</code><code class="descname">dew_point_temperature</code><span class="sig-paren">(</span><em>vapor_pressure</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/atmos.html#dew_point_temperature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#atmos.dew_point_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns dew point temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vapor_pressure</strong> (<em>ndarray</em>) – Water vapor pressure (Pa).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Dew point temperature (K).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Method from Vaisala’s white paper: “Humidity conversion formulas”.</p>
</dd></dl>

<dl class="function">
<dt id="atmos.gas_atten">
<code class="descclassname">atmos.</code><code class="descname">gas_atten</code><span class="sig-paren">(</span><em>model</em>, <em>cat_bits</em>, <em>height</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/atmos.html#gas_atten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#atmos.gas_atten" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns gas attenuation (assumes saturation inside liquid droplets).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<em>dict</em>) – Interpolated 2-D model fields {‘gas_atten’,
‘specific_gas_atten’, ‘specific_saturated_gas_atten’}.</li>
<li><strong>cat_bits</strong> (<em>ndarray</em>) – 2-D array of integers containing
categorize flag bits.</li>
<li><strong>height</strong> (<em>ndarray</em>) – 1-D altitude grid (m).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Attenuation due to atmospheric gases.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#cloudnetarray.CloudnetArray" title="cloudnetarray.CloudnetArray">CloudnetArray</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="atmos.get_attenuations">
<code class="descclassname">atmos.</code><code class="descname">get_attenuations</code><span class="sig-paren">(</span><em>model</em>, <em>mwr</em>, <em>classification</em>, <em>height</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/atmos.html#get_attenuations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#atmos.get_attenuations" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for attenuations.</p>
</dd></dl>

<dl class="function">
<dt id="atmos.k2c">
<code class="descclassname">atmos.</code><code class="descname">k2c</code><span class="sig-paren">(</span><em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/atmos.html#k2c"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#atmos.k2c" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts Kelvins to Celsius.</p>
</dd></dl>

<dl class="function">
<dt id="atmos.liquid_atten">
<code class="descclassname">atmos.</code><code class="descname">liquid_atten</code><span class="sig-paren">(</span><em>mwr</em>, <em>model</em>, <em>classification</em>, <em>height</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/atmos.html#liquid_atten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#atmos.liquid_atten" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates attenuation due to liquid water.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mwr</strong> (<a class="reference internal" href="#categorize.Mwr" title="categorize.Mwr"><em>Mwr</em></a>) – Mwr data container.</li>
<li><strong>model</strong> (<a class="reference internal" href="#categorize.Model" title="categorize.Model"><em>Model</em></a>) – Model data container.</li>
<li><strong>classification</strong> (<a class="reference internal" href="#classify.ClassificationResult" title="classify.ClassificationResult"><em>ClassificationResult</em></a>) – Classification container.</li>
<li><strong>height</strong> (<em>ndarray</em>) – 1-D altitude grid (m).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>Dict containing</p>
<ul class="simple">
<li><strong>radar_liquid_atten</strong> (<em>MaskedArray</em>): Amount of liquid attenuation.</li>
<li><strong>liquid_atten_err</strong> (<em>MaskedArray</em>): Error in the liquid attenuation.</li>
<li><strong>liquid_corrected</strong> (<em>ndarray</em>): Boolean array denoting where liquid
attenuation is present and we can compute its value.</li>
<li><strong>liquid_uncorrected</strong> (<em>ndarray</em>): Boolean array denoting where liquid
attenuation is present but we can not compute its value.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="atmos.saturation_vapor_pressure">
<code class="descclassname">atmos.</code><code class="descname">saturation_vapor_pressure</code><span class="sig-paren">(</span><em>temp_kelvin</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/atmos.html#saturation_vapor_pressure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#atmos.saturation_vapor_pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns approximate water vapour saturation pressure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>temp_kelvin</strong> (<em>ndarray</em>) – Temperature in K.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Vapor saturation pressure in Pa.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Vaisala’s white paper: “Humidity conversion formulas”.</p>
</dd></dl>

<dl class="function">
<dt id="atmos.wet_bulb">
<code class="descclassname">atmos.</code><code class="descname">wet_bulb</code><span class="sig-paren">(</span><em>model_data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/atmos.html#wet_bulb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#atmos.wet_bulb" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns wet bulb temperature.</p>
<p>Returns wet bulb temperature for given temperature,
pressure and relative humidity. Algorithm is based on a Taylor
expansion of a simple expression for the saturated vapour pressure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>model_data</strong> (<em>dict</em>) – Model variables ‘temperature’, ‘pressure’, ‘rh’.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Wet bulb temperature (K).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>J. Sullivan and L. D. Sanders: Method for obtaining wet-bulb
temperatures by modifying the psychrometric formula.</p>
</dd></dl>

</div>
<div class="section" id="module-droplet">
<span id="cloudnetpy-droplet"></span><h2>cloudnetpy.droplet<a class="headerlink" href="#module-droplet" title="Permalink to this headline">¶</a></h2>
<p>This module has functions for liquid layer detection.</p>
<dl class="function">
<dt id="droplet.correct_liquid_top">
<code class="descclassname">droplet.</code><code class="descname">correct_liquid_top</code><span class="sig-paren">(</span><em>obs</em>, <em>liquid</em>, <em>is_freezing</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/droplet.html#correct_liquid_top"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#droplet.correct_liquid_top" title="Permalink to this definition">¶</a></dt>
<dd><p>Corrects lidar detected liquid cloud top using radar data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obs</strong> (<em>ClassData</em>) – Observations container.</li>
<li><strong>liquid</strong> (<em>dict</em>) – Dictionary for liquid clouds.</li>
<li><strong>is_freezing</strong> (<em>ndarray</em>) – 2-D boolean array of sub-zero temperature,
derived from the model temperature and melting layer based
on radar data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Corrected liquid cloud array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">droplet.find_liquid()</p>
</div>
</dd></dl>

<dl class="function">
<dt id="droplet.find_liquid">
<code class="descclassname">droplet.</code><code class="descname">find_liquid</code><span class="sig-paren">(</span><em>obs</em>, <em>peak_amp=2e-05</em>, <em>max_width=300</em>, <em>min_points=3</em>, <em>min_top_der=2e-07</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/droplet.html#find_liquid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#droplet.find_liquid" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate liquid layers from SNR-screened attenuated backscattering.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obs</strong> (<em>ClassData</em>) – Observations container.</li>
<li><strong>peak_amp</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum value of peak. Default is 2e-5.</li>
<li><strong>max_width</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum width of peak. Default is 300 (m).</li>
<li><strong>min_points</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of valid points in peak.
Default is 3.</li>
<li><strong>min_top_der</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum derivative above peak,
defined as (beta_peak-beta_top) / (alt_top-alt_peak), which
is always positive. Default is 2e-7.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Dict containing ‘presence’, ‘bases’ and ‘tops’.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="droplet.ind_base">
<code class="descclassname">droplet.</code><code class="descname">ind_base</code><span class="sig-paren">(</span><em>dprof</em>, <em>p</em>, <em>dist</em>, <em>lim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/droplet.html#ind_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#droplet.ind_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds base index of a peak in profile.</p>
<p>Return the lowermost index of profile where 1st order differences
below the peak exceed a threshold value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dprof</strong> (<em>ndarray</em>) – 1-D array of 1st discrete difference.
Masked values should be 0, e.g. dprof =
np.diff(masked_prof).filled(0)</li>
<li><strong>p</strong> (<em>int</em>) – Index of (possibly local) peak in the original profile.
Note that the peak must be found with some other method prior
calling this function.</li>
<li><strong>dist</strong> (<em>int</em>) – Number of elements investigated below <em>p</em>.
If ( <em>p</em> - <em>dist</em>)&lt;0, search starts from index 0.</li>
<li><strong>lim</strong> (<em>float</em>) – Parameter for base index. Values greater than 1.0
are valid. Values close to 1 most likely return the
point right below the maximum 1st order difference
(within <em>dist</em> points below <em>p</em>).
Values larger than 1 more likely
accept some other point, lower in the profile.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Base index of the peak.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Consider a profile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">99</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>that contains one bad, masked value</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mx</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">    [0 0.5, 1.0, --, 4.0, 8.0, 5.0]</span>
</pre></div>
</div>
<p>The 1st order difference is now</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">mx</span><span class="p">)</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">    [0.5 0.5,  0. ,  0. ,  4. , -3. ]</span>
</pre></div>
</div>
<p>From the original profile we see that the peak index is 5.
Let’s assume our base can’t be more than 4 elements below
peak and the threshold value is 2. Thus we call</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ind_base</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">    4</span>
</pre></div>
</div>
<p>When x[4] is the lowermost point that satisfies the condition.
Changing the threshold value would alter the result</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ind_base</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">    1</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">droplet.ind_top()</p>
</div>
</dd></dl>

<dl class="function">
<dt id="droplet.ind_top">
<code class="descclassname">droplet.</code><code class="descname">ind_top</code><span class="sig-paren">(</span><em>dprof</em>, <em>p</em>, <em>nprof</em>, <em>dist</em>, <em>lim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/droplet.html#ind_top"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#droplet.ind_top" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds top index of a peak in profile.</p>
<p>Return the uppermost index of profile where 1st order differences
above the peak exceed a threshold value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dprof</strong> (<em>ndarray</em>) – 1-D array of 1st discrete difference.
Masked values should be 0, e.g. dprof =
np.diff(masked_prof).filled(0)</li>
<li><strong>nprof</strong> (<em>int</em>) – Length of the profile. Top index can’t be higher
than this.</li>
<li><strong>p</strong> (<em>int</em>) – Index of (possibly local) peak in the profile.
Note that the peak must be found with some other method prior
calling this function.</li>
<li><strong>dist</strong> (<em>int</em>) – Number of elements investigated above <em>p</em>.
If (<em>p</em> + <em>dist</em>) &gt; <em>nprof</em>, search ends to <em>nprof</em>.</li>
<li><strong>lim</strong> (<em>float</em>) – Parameter for top index. Values greater than 1.0
are valid. Values close to 1 most likely return the
point right above the maximum 1st order difference
(within <em>dist</em> points above <em>p</em>).
Values larger than 1 more likely
accept some other point, higher in the profile.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Top index of the peak.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">droplet.ind_base()</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-lwc">
<span id="cloudnetpy-lwc"></span><h2>cloudnetpy.lwc<a class="headerlink" href="#module-lwc" title="Permalink to this headline">¶</a></h2>
<p>Module for liquid water content calculations.</p>
<dl class="function">
<dt id="lwc.adiabatic_lwc">
<code class="descclassname">lwc.</code><code class="descname">adiabatic_lwc</code><span class="sig-paren">(</span><em>T</em>, <em>P</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lwc.html#adiabatic_lwc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lwc.adiabatic_lwc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns adiabatic LWC change rate.</p>
<p>Calculates the theoretical adiabatic rate of increase of LWC with
height, or pressure, given the cloud base temperature and pressure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>T</strong> (<em>ndarray</em>) – Temperature of cloud base (K).</li>
<li><strong>P</strong> (<em>ndarray</em>) – Pressure of cloud base (Pa).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dlwc/dz in kg m-3 m-1</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Brenguier, 1991, <a class="reference external" href="https://bit.ly/2QCSJtb">https://bit.ly/2QCSJtb</a></p>
</dd></dl>

<dl class="function">
<dt id="lwc.temp2mixingratio">
<code class="descclassname">lwc.</code><code class="descname">temp2mixingratio</code><span class="sig-paren">(</span><em>T</em>, <em>P</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lwc.html#temp2mixingratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lwc.temp2mixingratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts temperature and pressure to mixing ratio.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>T</strong> (<em>ndarray</em>) – Temperature (K).</li>
<li><strong>P</strong> (<em>ndarray</em>) – Pressure (Pa).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Mixing ratio.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-cloudnetarray">
<span id="cloudnetpy-cloudnetarray"></span><h2>cloudnetpy.cloudnetarray<a class="headerlink" href="#module-cloudnetarray" title="Permalink to this headline">¶</a></h2>
<p>CloudnetArray class.</p>
<dl class="class">
<dt id="cloudnetarray.CloudnetArray">
<em class="property">class </em><code class="descclassname">cloudnetarray.</code><code class="descname">CloudnetArray</code><span class="sig-paren">(</span><em>netcdf4_variable</em>, <em>name</em>, <em>units_from_user=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cloudnetarray.html#CloudnetArray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cloudnetarray.CloudnetArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores NetCDF variables as CloudnetArrays.</p>
<dl class="attribute">
<dt id="cloudnetarray.CloudnetArray.name">
<code class="descname">name</code><a class="headerlink" href="#cloudnetarray.CloudnetArray.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="cloudnetarray.CloudnetArray.data">
<code class="descname">data</code><a class="headerlink" href="#cloudnetarray.CloudnetArray.data" title="Permalink to this definition">¶</a></dt>
<dd><p>The actual data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="cloudnetarray.CloudnetArray.data_type">
<code class="descname">data_type</code><a class="headerlink" href="#cloudnetarray.CloudnetArray.data_type" title="Permalink to this definition">¶</a></dt>
<dd><p>‘i4’ for integers, ‘f4’ for floats.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="cloudnetarray.CloudnetArray.units">
<code class="descname">units</code><a class="headerlink" href="#cloudnetarray.CloudnetArray.units" title="Permalink to this definition">¶</a></dt>
<dd><p>Copied from the original netcdf4
variable (if existing).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cloudnetarray.CloudnetArray.db2lin">
<code class="descname">db2lin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cloudnetarray.html#CloudnetArray.db2lin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cloudnetarray.CloudnetArray.db2lin" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts log units to linear.</p>
</dd></dl>

<dl class="method">
<dt id="cloudnetarray.CloudnetArray.fetch_attributes">
<code class="descname">fetch_attributes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cloudnetarray.html#CloudnetArray.fetch_attributes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cloudnetarray.CloudnetArray.fetch_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of user-defined attributes.</p>
</dd></dl>

<dl class="method">
<dt id="cloudnetarray.CloudnetArray.lin2db">
<code class="descname">lin2db</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cloudnetarray.html#CloudnetArray.lin2db"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cloudnetarray.CloudnetArray.lin2db" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts linear units do log.</p>
</dd></dl>

<dl class="method">
<dt id="cloudnetarray.CloudnetArray.mask_indices">
<code class="descname">mask_indices</code><span class="sig-paren">(</span><em>ind</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cloudnetarray.html#CloudnetArray.mask_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cloudnetarray.CloudnetArray.mask_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks data from given indices.</p>
</dd></dl>

<dl class="method">
<dt id="cloudnetarray.CloudnetArray.rebin_data">
<code class="descname">rebin_data</code><span class="sig-paren">(</span><em>time</em>, <em>time_new</em>, <em>height=None</em>, <em>height_new=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cloudnetarray.html#CloudnetArray.rebin_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cloudnetarray.CloudnetArray.rebin_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebins data in time and optionally in height.</p>
</dd></dl>

<dl class="method">
<dt id="cloudnetarray.CloudnetArray.rebin_in_polar">
<code class="descname">rebin_in_polar</code><span class="sig-paren">(</span><em>time</em>, <em>time_new</em>, <em>folding_velocity</em>, <em>sequence_indices</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cloudnetarray.html#CloudnetArray.rebin_in_polar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cloudnetarray.CloudnetArray.rebin_in_polar" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebins velocity in polar coordinates.</p>
<p>Velocity needs to be averaged in polar coordinates due to folding.</p>
</dd></dl>

<dl class="method">
<dt id="cloudnetarray.CloudnetArray.set_attributes">
<code class="descname">set_attributes</code><span class="sig-paren">(</span><em>attributes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cloudnetarray.html#CloudnetArray.set_attributes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cloudnetarray.CloudnetArray.set_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Set some attributes if they exist.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-utils">
<span id="cloudnetpy-utils"></span><h2>cloudnetpy.utils<a class="headerlink" href="#module-utils" title="Permalink to this headline">¶</a></h2>
<p>This module contains general
helper functions.</p>
<dl class="function">
<dt id="utils.bases_and_tops">
<code class="descclassname">utils.</code><code class="descname">bases_and_tops</code><span class="sig-paren">(</span><em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#bases_and_tops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.bases_and_tops" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds islands of ones from boolean 1-D array.</p>
<p>From a binary vector finds all “islands” of
ones, i.e. their starting and ending indices.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>y</strong> (<em>array_like</em>) – 1-D array of ones and zeros.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">2-element tuple containing<ul class="simple">
<li><em>ndarray</em>: Indices of bases.</li>
<li><em>ndarray</em>: Indices of tops.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bases_and_tops</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">    ([3, 7], [4, 9])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.binvec">
<code class="descclassname">utils.</code><code class="descname">binvec</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#binvec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.binvec" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts 1-D center points to bins with even spacing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>array_like</em>) – 1-D array of N real values.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">N + 1 edge values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">binvec</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">    [0.5, 1.5, 2.5, 3.5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.cumsumr">
<code class="descclassname">utils.</code><code class="descname">cumsumr</code><span class="sig-paren">(</span><em>x</em>, <em>axis=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#cumsumr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.cumsumr" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds cumulative sum that resets on 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>ndarray</em>) – Input array.</li>
<li><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) – Axis where the sum is calculated.
Default is 0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Cumulative sum, restarted at 0.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cumsumr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">    [0, 0, 1, 2, 0, 0, 0, 1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.db2lin">
<code class="descclassname">utils.</code><code class="descname">db2lin</code><span class="sig-paren">(</span><em>x</em>, <em>scale=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#db2lin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.db2lin" title="Permalink to this definition">¶</a></dt>
<dd><p>dB to linear conversion.</p>
</dd></dl>

<dl class="function">
<dt id="utils.ffill">
<code class="descclassname">utils.</code><code class="descname">ffill</code><span class="sig-paren">(</span><em>arr</em>, <em>value=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#ffill"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.ffill" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward fills a numpy array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr</strong> (<em>ndarray</em>) – 1-D or 2-D array.</li>
<li><strong>value</strong> (<em>int</em>) – Value to be filled. Default is 0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Forward-filled array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ffill</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">    [0, 5, 5, 5, 2, 2]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>Works only in axis=1 direction.</p>
</dd></dl>

<dl class="function">
<dt id="utils.filter_isolated_pixels">
<code class="descclassname">utils.</code><code class="descname">filter_isolated_pixels</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#filter_isolated_pixels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.filter_isolated_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns array with completely isolated single cells removed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array</strong> (<em>ndarray</em>) – 2-D input data with shape.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Cleaned data.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.findkey">
<code class="descclassname">utils.</code><code class="descname">findkey</code><span class="sig-paren">(</span><em>vrs</em>, <em>possible_fields</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#findkey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.findkey" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds first matching key from several possible.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vrs</strong> (<em>dict</em>) – Dictionary or other
iterable containing strings.</li>
<li><strong>possible_fields</strong> (<em>tuple</em>) – List of possible strings to be
searched.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">First matching key. None if nothing found.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;abc&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bac&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;cba&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">findkey</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;bac&#39;</span><span class="p">,</span> <span class="s1">&#39;cba&#39;</span><span class="p">))</span>
<span class="go">    &#39;bac&#39;</span>
</pre></div>
</div>
<p>The order of the keys to be searched is defaining
the return value if there are several matching strings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">findkey</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;cba&#39;</span><span class="p">,</span> <span class="s1">&#39;bac&#39;</span><span class="p">))</span>
<span class="go">    &#39;cba&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.get_time">
<code class="descclassname">utils.</code><code class="descname">get_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#get_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.get_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns current UTC-time.</p>
</dd></dl>

<dl class="function">
<dt id="utils.get_uuid">
<code class="descclassname">utils.</code><code class="descname">get_uuid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#get_uuid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.get_uuid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns unique identifier.</p>
</dd></dl>

<dl class="function">
<dt id="utils.init">
<code class="descclassname">utils.</code><code class="descname">init</code><span class="sig-paren">(</span><em>nvars</em>, <em>shape</em>, <em>dtype=&lt;class 'float'&gt;</em>, <em>masked=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes several numpy arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nvars</strong> (<em>int</em>) – Number of arrays to be generated.</li>
<li><strong>shape</strong> (<em>tuple</em>) – Shape of the arrays, e.g. (2, 3).</li>
<li><strong>dtype</strong> (<em>data-type</em><em>, </em><em>optional</em>) – The desired data-type
for the arrays, e.g., int. Default is float.</li>
<li><strong>masked</strong> (<em>bool</em>) – If True, generated arrays are masked
arrays, else ordinary numpy arrays. Default is True.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last">Iterator containing the empty arrays.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">init</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">    masked_array(</span>
<span class="go">      data=[[0., 0., 0.],</span>
<span class="go">            [0., 0., 0.]],</span>
<span class="go">      mask=False,</span>
<span class="go">      fill_value=1e+20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.interpolate_2d">
<code class="descclassname">utils.</code><code class="descname">interpolate_2d</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>z</em>, <em>x_new</em>, <em>y_new</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#interpolate_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.interpolate_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear interpolation of gridded 2d data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>ndarray</em>) – 1-D array.</li>
<li><strong>y</strong> (<em>ndarray</em>) – 1-D array.</li>
<li><strong>z</strong> (<em>ndarray</em>) – 2-D array at points (x, y).</li>
<li><strong>x_new</strong> (<em>ndarray</em>) – 1-D array.</li>
<li><strong>y_new</strong> (<em>ndarray</em>) – 1-D array.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Interpolated data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Does not work with nans. Ignores mask of masked data.
Does not extrapolate.</p>
</dd></dl>

<dl class="function">
<dt id="utils.isbit">
<code class="descclassname">utils.</code><code class="descname">isbit</code><span class="sig-paren">(</span><em>integer</em>, <em>nth_bit</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#isbit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.isbit" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if nth bit (0,1,2..) is on for the input number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>integer</strong> (<em>int</em>) – A number.</li>
<li><strong>nth_bit</strong> (<em>int</em>) – Investigated bit.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True if set, otherwise False.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">bool</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – negative bit as input.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">isbit</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">    False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isbit</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">    True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">utils.setbit()</p>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.isscalar">
<code class="descclassname">utils.</code><code class="descname">isscalar</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#isscalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.isscalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if input is scalar.</p>
<p>By “scalar” we mean that array has a single value.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">isscalar</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isscalar</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isscalar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isscalar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.l2norm">
<code class="descclassname">utils.</code><code class="descname">l2norm</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#l2norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.l2norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns l2 norm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>*args</strong> – Variable number of data (<em>array_like</em>)
with the same shape.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The l2 norm.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">MaskedArray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.lin2db">
<code class="descclassname">utils.</code><code class="descname">lin2db</code><span class="sig-paren">(</span><em>x</em>, <em>scale=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#lin2db"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.lin2db" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear to dB conversion.</p>
</dd></dl>

<dl class="function">
<dt id="utils.mdiff">
<code class="descclassname">utils.</code><code class="descname">mdiff</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#mdiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.mdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns median difference of 1-D array.</p>
</dd></dl>

<dl class="function">
<dt id="utils.n_elements">
<code class="descclassname">utils.</code><code class="descname">n_elements</code><span class="sig-paren">(</span><em>x</em>, <em>dist</em>, <em>var=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#n_elements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.n_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of elements that cover certain distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>ndarray</em>) – Input array with arbitrary units
or time in fraction hour. <em>x</em> should be
evenly spaced or at least close to.</li>
<li><strong>dist</strong> (<em>float</em>) – Distance to be covered. If x is fraction time,
<em>dist</em> is in minutes. Otherwise <em>x</em> and <em>dist</em> should have
the same units.</li>
<li><strong>var</strong> (<em>str</em><em>, </em><em>optional</em>) – ‘time’ or None. If None, inputs
have the same units. If ‘time’, input is fraction hour
and distance in minutes. Default is None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Number of elements in the input array that cover <em>dist</em>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_elements</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">    3</span>
</pre></div>
</div>
<p>The result is rounded to the closest integer, so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_elements</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">6.9</span><span class="p">)</span>
<span class="go">    3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_elements</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">    4</span>
</pre></div>
</div>
<p>With fraction hour time vector:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">61</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_elements</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="go">    10</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.read_cloudnet_database">
<code class="descclassname">utils.</code><code class="descname">read_cloudnet_database</code><span class="sig-paren">(</span><em>site</em>, <em>*fields_in</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#read_cloudnet_database"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.read_cloudnet_database" title="Permalink to this definition">¶</a></dt>
<dd><p>Read metadata from Cloudnet http API.</p>
</dd></dl>

<dl class="function">
<dt id="utils.rebin_2d">
<code class="descclassname">utils.</code><code class="descname">rebin_2d</code><span class="sig-paren">(</span><em>x_in</em>, <em>data</em>, <em>x_new</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#rebin_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.rebin_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebins 2-D data in one dimension using mean.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x_in</strong> (<em>ndarray</em>) – 1-D array with shape (n,).</li>
<li><strong>data</strong> (<em>MaskedArray</em>) – 2-D input data with shape (n, m).</li>
<li><strong>x_new</strong> (<em>ndarray</em>) – 1-D target vector (center points)
with shape (N,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Rebinned (averaged) data with shape (N, m).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">MaskedArray</p>
</td>
</tr>
</tbody>
</table>
<p>Notes: 0-values are masked in the returned array.</p>
</dd></dl>

<dl class="function">
<dt id="utils.seconds2hours">
<code class="descclassname">utils.</code><code class="descname">seconds2hours</code><span class="sig-paren">(</span><em>time_in_seconds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#seconds2hours"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.seconds2hours" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts seconds since some epoch to fraction hour.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time_in_seconds</strong> (<em>ndarray</em>) – 1-D array of seconds since some epoch
that starts on midnight.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Time as fraction hour.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Excludes leap seconds.</p>
</dd></dl>

<dl class="function">
<dt id="utils.setbit">
<code class="descclassname">utils.</code><code class="descname">setbit</code><span class="sig-paren">(</span><em>integer</em>, <em>nth_bit</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#setbit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.setbit" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets nth bit (0, 1, 2..) on input number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>integer</strong> (<em>int</em>) – A number.</li>
<li><strong>nth_bit</strong> (<em>int</em>) – Bit to be set.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Integer where nth bit is set.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">int</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – negative bit as input.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">setbit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">    3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setbit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">    4</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">utils.isbit()</p>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.time_grid">
<code class="descclassname">utils.</code><code class="descname">time_grid</code><span class="sig-paren">(</span><em>time_step=30</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#time_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.time_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns decimal hour array between 0 and 24.</p>
<p>Computes fraction hour time vector 0-24 with user-given
resolution (in seconds) where 60 is the maximum allowed value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time_step</strong> (<em>int</em><em>, </em><em>optional</em>) – Time resolution in seconds between
1 and 60. Default is 30.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Time vector between 0 and 24.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Bad resolution as input.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">High-level APIs</a></li>
<li><a class="reference internal" href="#modules">Modules</a><ul>
<li><a class="reference internal" href="#module-categorize">cloudnetpy.categorize</a></li>
<li><a class="reference internal" href="#module-classify">cloudnetpy.classify</a></li>
<li><a class="reference internal" href="#module-atmos">cloudnetpy.atmos</a></li>
<li><a class="reference internal" href="#module-droplet">cloudnetpy.droplet</a></li>
<li><a class="reference internal" href="#module-lwc">cloudnetpy.lwc</a></li>
<li><a class="reference internal" href="#module-cloudnetarray">cloudnetpy.cloudnetarray</a></li>
<li><a class="reference internal" href="#module-utils">cloudnetpy.utils</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="quickstart.html"
                        title="previous chapter">Quickstart</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/api.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="quickstart.html" title="Quickstart"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CloudnetPy  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Finnish Meteorological Institute.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.
    </div>
  </body>
</html>